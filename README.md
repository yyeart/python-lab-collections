# Лабораторная работа
Смирнов Вячеслав М8О-106БВ-25

## Симуляция с пользовательсĸими ĸоллеĸциями и псевдослучайной моделью



## Структура проекта

 <pre>
    .
    ├── python-lab-collections                 # Кодовая база лабораторной работы
    │   ├── src/                               # Исходный код
    │   |   ├── books/                         # Классы книг
    │   |   |   ├── audio_book.py              # Аудио книга
    │   |   |   ├── base.py                    # Абстрактный класс
    │   |   |   ├── electronic_book.py         # Электронная книга
    │   |   |   ├── printed_book.py            # Печатная книга
    │   |   ├── collections/                   # Классы коллекций
    │   |   |   ├── author_index.py            # Индексирование по имени автора
    │   |   |   ├── base.py                    # Абстрактный класс
    │   |   |   ├── book_collection.py         # Списковая коллекция книг
    │   |   |   ├── genre_index.py             # Индексирование по жанру
    │   |   |   ├── isbn_index.py              # Индексирование по уникальному номеру ISBN
    │   |   |   ├── year_index.py              # Индексирование по году издания
    │   |   ├── __init__.py__
    │   |   ├── config.py                      # Конфиг для логгера
    │   |   ├── constants.py                   # Константы
    │   |   ├── exceptions.py                  # Кастомные исключения при работе библиотеки
    │   |   ├── library.py                     # Класс библиотеки
    │   |   ├── main.py                        # Главный модуль приложения
    │   |   ├── setup_logger.py                # Установка конфига для логгера
    │   |   ├── simulation.py                  # Модуль псевдослучайной симуляции работы библиотеки
    │   ├── tests/                             # Unit тесты
    │   |   ├── __init__.py
    │   |   ├── fixtures.py                    # Содержит фикстуры книг и библиотеки
    │   |   ├── test_book.py                   # Тесты функций классов книг
    │   |   ├── test_collections.py            # Тесты функций классов коллекций
    │   |   ├── test_library.py                # Тесты функций библиотеки
    │   |   ├── test_simulation.py             # Тесты работы симуляции
    │   ├── .gitignore                         # git ignore файл
    │   ├──.pre-commit-config.yaml             # Средства автоматизации проверки кодстайла
    │   ├── README.md                          # Описание проекта
    │   ├── pyproject.toml                     # Конфигурация проекта
    │   ├── requirements.txt                   # Зависимости
    │   ├── uv.lock                            # Зависимости
</pre>

### Классы книг
#### BaseBook
* Абстрактный базовый класс книги. Содержит общие поля: название, автор, год, жанр и ISBN
#### PrintedBook
* Печатная книга. Дополнительные поля: кол-во страниц, вес
#### EBook
* Электронная книга. Дополнительные поля: размер файла (в МБ), формат файла
#### AudioBook
* Аудио книга. Дополнительные поля: длительность (в мин), битрейт, имя диктора

### Классы коллекций
#### BookCollection
* Списковая коллекция всех объектов. Умеет делать срезы, поддерживает итерацию, `__len__`
#### BaseIndex
* Базовый класс для поиска.
#### ISBNIndex
* Позволяет найти книгу по ее уникальному ISBN

#### (Author/Genre/Year)Index
* Словарные коллекции. Позволяют найти список книг конкретного автора, жанра или года издания
### Библиотека
#### Library
* Класс библиотеки. Содержит коллекцию всех книг (`BookCollection`), коллекции индексов (`GenreIndex, YearIndex, AuthorIndex, ISBNIndex`)

## Симуляция
1. Создается объект библиотеки
2. Генерируются `n` случайных книг и добавляются в соответствующие коллекции
3. Запускается цикл обработки событий с логированием всех операций в консоль
4. Выводится состояние библиотеки после проведения всех операций

## Тестирование
* Все команды покрыты юнит-тестами с использованием pytest и unittest.mock, процент покрытия >= 80%
* Применяется `side_effect` для тестирования случайных событий симуляции
* Запуск тестов: `pytest -v`
* Проверка покрытия тестов: `pytest -v --cov=src`

## Логирование
* Логи хранятся в файле shell.log и включают:
    * дату, время
    * номер шага, тип операции
    * сообщения об ошибках

## Допущения
* ISBN считается уникальным ключом, попытка добавить книгу с существующим ISBN вызывет исключение `DuplicateBookError`
* Поиск по автору, жанру и году возвращает список объектов, так как эти критерии не уникальны
